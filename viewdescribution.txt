Virtual Office é¡¹ç›®
ä¸€ä¸ªåŸºäº Electron + React + TypeScript çš„è™šæ‹ŸåŠå…¬ç©ºé—´åº”ç”¨ï¼Œæä¾›åœ¨çº¿åä½œã€å®æ—¶èŠå¤©å’Œè§†é¢‘ä¼šè®®ç­‰åŠŸèƒ½ã€‚

é¡¹ç›®æ¦‚è§ˆ
Virtual Office æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è¿œç¨‹åŠå…¬åä½œå¹³å°ï¼Œé€šè¿‡è™šæ‹Ÿç©ºé—´æ¨¡æ‹Ÿçº¿ä¸‹åŠå…¬å®¤ç¯å¢ƒï¼Œè®©å›¢é˜Ÿæˆå‘˜å¯ä»¥åœ¨çº¿è¿›è¡Œå®æ—¶äº¤æµå’Œåä½œã€‚

ä¸»è¦åŠŸèƒ½
ğŸš€ è™šæ‹ŸåŠå…¬ç©ºé—´ï¼šå¯è§†åŒ–åŠå…¬ç¯å¢ƒï¼Œæ˜¾ç¤ºå›¢é˜Ÿæˆå‘˜ä½ç½®å’ŒçŠ¶æ€
ğŸ’¬ å®æ—¶èŠå¤©ï¼šæ”¯æŒå…¬å…±é¢‘é“å’Œç§äººæ¶ˆæ¯ï¼Œæ”¯æŒæ¶ˆæ¯ç¿»è¯‘
ğŸ“¹ è§†é¢‘ä¼šè®®ï¼šåˆ›å»ºä¼šè®®å®¤ï¼Œæ”¯æŒéŸ³è§†é¢‘é€šè¯ã€å±å¹•å…±äº«
ğŸ‘¤ ç”¨æˆ·ç®¡ç†ï¼šç”¨æˆ·è®¤è¯ã€ä¸ªäººèµ„æ–™ç®¡ç†ã€å¤´åƒåˆ›å»º
ğŸ“± å“åº”å¼è®¾è®¡ï¼šæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡
é¡¹ç›®ç»“æ„
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/             # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â””â”€â”€ index.ts      # ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ preload/          # é¢„åŠ è½½è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ index.d.ts    # ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts      # é¢„åŠ è½½è„šæœ¬å®ç°
â”‚   â””â”€â”€ renderer/         # æ¸²æŸ“è¿›ç¨‹
â”‚       â”œâ”€â”€ index.html    # HTML å…¥å£
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ App.tsx   # åº”ç”¨ä¸»ç»„ä»¶
â”‚           â”œâ”€â”€ api/      # API æ¥å£æœåŠ¡
â”‚           â”œâ”€â”€ assets/   # é™æ€èµ„æº
â”‚           â”œâ”€â”€ components/ # React ç»„ä»¶
â”‚           â”œâ”€â”€ styles/   # æ ·å¼æ–‡ä»¶
â”‚           â”œâ”€â”€ types/    # TypeScript ç±»å‹å®šä¹‰
â”‚           â””â”€â”€ main.tsx  # æ¸²æŸ“è¿›ç¨‹å…¥å£
â”œâ”€â”€ build/                # æ„å»ºç›¸å…³èµ„æº
â”œâ”€â”€ electron.vite.config.ts # Vite é…ç½®
â”œâ”€â”€ tsconfig.json         # TypeScript é…ç½®
â””â”€â”€ package.json          # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬
æ ¸å¿ƒç»„ä»¶
VirtualOfficeï¼šè™šæ‹ŸåŠå…¬ç©ºé—´ä¸»ç»„ä»¶ï¼Œç®¡ç†ç”¨æˆ·ä½ç½®å’Œäº¤äº’
UserAvatarï¼šç”¨æˆ·å¤´åƒç»„ä»¶ï¼Œæ”¯æŒæ‹–æ”¾ç§»åŠ¨å’Œä¿¡æ¯å±•ç¤º
ChatPageï¼šèŠå¤©åŠŸèƒ½é¡µé¢ï¼ŒåŒ…å«èŠå¤©é¢‘é“å’Œæ¶ˆæ¯ç•Œé¢
MeetingRoomï¼šè§†é¢‘ä¼šè®®å®¤ç»„ä»¶
OnlinePanelï¼šåœ¨çº¿ç”¨æˆ·é¢æ¿
Authï¼šç”¨æˆ·è®¤è¯ç»„ä»¶
æŠ€æœ¯æ ˆ
å‰ç«¯æ¡†æ¶ï¼šReact 19 + TypeScript
æ¡Œé¢åº”ç”¨æ¡†æ¶ï¼šElectron 38
æ„å»ºå·¥å…·ï¼šVite 7
UI ç»„ä»¶åº“ï¼šRadix UI
æ ·å¼æ–¹æ¡ˆï¼šTailwind CSS 4
çŠ¶æ€ç®¡ç†ï¼šReact Hooks
HTTP å®¢æˆ·ç«¯ï¼šAxios
å›¾æ ‡åº“ï¼šLucide React
å¼€å‘ä¸æ„å»º
ç¯å¢ƒè¦æ±‚
Node.js 18+
npm æˆ– yarn
å®‰è£…ä¾èµ–
$ npm install
å¼€å‘æ¨¡å¼
$ npm run dev
æ„å»ºåº”ç”¨
# Windows ç‰ˆæœ¬
$ npm run build:win

# macOS ç‰ˆæœ¬
$ npm run build:mac

# Linux ç‰ˆæœ¬
$ npm run build:linux
åç«¯ Spring Boot å¼€å‘äººå‘˜æ¥å£ä½¿ç”¨æ‰‹å†Œ
æ¥å£åŸºç¡€ä¿¡æ¯
API åŸºç¡€ URLï¼šhttp://localhost:8080/api/v1
è®¤è¯æ–¹å¼ï¼šJWT Token (Bearer è®¤è¯)
è¯·æ±‚/å“åº”æ ¼å¼ï¼šJSON
WebSocket URLï¼šws://localhost:8080/ws (éœ€åœ¨æŸ¥è¯¢å‚æ•°ä¸­æä¾› token)
åç«¯å®ç°æŒ‡å—
1. ç”¨æˆ·è®¤è¯æ¨¡å—
åç«¯éœ€å®ç°ä»¥ä¸‹ API æ¥å£ï¼š

ç™»å½•ï¼šPOST /auth/login
æ³¨å†Œï¼šPOST /auth/register
è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼šGET /auth/me
æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼šPUT /auth/profile
2. è™šæ‹Ÿç©ºé—´æ¨¡å—
åç«¯éœ€å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š

è™šæ‹Ÿç©ºé—´ç®¡ç†ï¼šåˆ›å»ºã€æŸ¥è¯¢è™šæ‹Ÿç©ºé—´åŠå…¶åŒºåŸŸå®šä¹‰
ç”¨æˆ·ä½ç½®è·Ÿè¸ªï¼šæ›´æ–°å’Œå¹¿æ’­ç”¨æˆ·åœ¨è™šæ‹Ÿç©ºé—´ä¸­çš„ä½ç½®
åœ¨çº¿çŠ¶æ€ç®¡ç†ï¼šå®æ—¶æ›´æ–°å’Œå¹¿æ’­ç”¨æˆ·åœ¨çº¿çŠ¶æ€
æ ¸å¿ƒæ¥å£ï¼š

GET /virtual-spaces - è·å–æ‰€æœ‰è™šæ‹Ÿç©ºé—´
PUT /virtual-spaces/position - æ›´æ–°ç”¨æˆ·ä½ç½®
GET /virtual-spaces/:spaceId/members - è·å–ç©ºé—´æˆå‘˜
3. èŠå¤©æ¨¡å—
åç«¯éœ€å®ç°ï¼š

é¢‘é“ç®¡ç†ï¼šåˆ›å»ºå’Œç®¡ç†èŠå¤©é¢‘é“
æ¶ˆæ¯ç³»ç»Ÿï¼šå‘é€ã€æ¥æ”¶å’Œå­˜å‚¨æ¶ˆæ¯
æ¶ˆæ¯ç¿»è¯‘ï¼šé›†æˆç¬¬ä¸‰æ–¹ç¿»è¯‘æœåŠ¡
æ ¸å¿ƒæ¥å£ï¼š

GET /chat/channels - è·å–é¢‘é“åˆ—è¡¨
GET /chat/channels/:channelId/messages - è·å–æ¶ˆæ¯
POST /chat/channels/:channelId/messages - å‘é€æ¶ˆæ¯
4. ä¼šè®®æ¨¡å—
åç«¯éœ€å®ç°ï¼š

ä¼šè®®å®¤ç®¡ç†ï¼šåˆ›å»ºå’Œé…ç½®ä¼šè®®å®¤
å‚ä¸è€…ç®¡ç†ï¼šåŠ å…¥/ç¦»å¼€ä¼šè®®ï¼Œæ›´æ–°å‚ä¸è€…çŠ¶æ€
å½•åˆ¶åŠŸèƒ½ï¼šä¼šè®®å½•åˆ¶çš„å¼€å§‹ã€åœæ­¢å’Œå­˜å‚¨
æ ¸å¿ƒæ¥å£ï¼š

GET /meetings/rooms - è·å–ä¼šè®®å®¤åˆ—è¡¨
POST /meetings/rooms/:meetingId/join - åŠ å…¥ä¼šè®®
PUT /meetings/rooms/:meetingId/participant/status - æ›´æ–°å‚ä¸è€…çŠ¶æ€
WebSocket å®ç°è¦æ±‚
åç«¯éœ€å®ç° WebSocket æœåŠ¡ï¼Œç”¨äºå®æ—¶é€šä¿¡ï¼š

è®¤è¯å¤„ç†ï¼šéªŒè¯ URL ä¸­çš„ JWT Token
æ¶ˆæ¯ç±»å‹ï¼š
POSITION_UPDATE: ç”¨æˆ·ä½ç½®æ›´æ–°å¹¿æ’­
NEW_MESSAGE: æ–°æ¶ˆæ¯é€šçŸ¥
MEETING_STATUS: ä¼šè®®çŠ¶æ€æ›´æ–°
æ•°æ®æ¨¡å‹è®¾è®¡
ä¸»è¦å®ä½“å…³ç³»ï¼š

ç”¨æˆ· (User)

ä¸ç”¨æˆ·ä¼šè¯ã€æ¶ˆæ¯ã€ä¼šè®®å‚ä¸è€…ç­‰å…³è”
è™šæ‹Ÿç©ºé—´ (VirtualSpace)

åŒ…å«å¤šä¸ªåŒºåŸŸ (Zone)
ä¸ç”¨æˆ·å­˜åœ¨çŠ¶æ€ (UserPresence) å…³è”
èŠå¤©é¢‘é“ (ChatChannel)

åŒ…å«å¤šä¸ªæ¶ˆæ¯ (Message)
ä¸ç”¨æˆ·å¤šå¯¹å¤šå…³è”
ä¼šè®®å®¤ (MeetingRoom)

åŒ…å«å¤šä¸ªå‚ä¸è€… (MeetingParticipant)
å®‰å…¨å»ºè®®
è®¤è¯ä¸æˆæƒï¼š

æ‰€æœ‰ API ç«¯ç‚¹éœ€éªŒè¯ JWT Token
å®ç°ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
æ•°æ®éªŒè¯ï¼š

å¯¹æ‰€æœ‰è¾“å…¥å‚æ•°è¿›è¡Œä¸¥æ ¼éªŒè¯
é˜²æ­¢ SQL æ³¨å…¥å’Œ XSS æ”»å‡»
é€Ÿç‡é™åˆ¶ï¼š

å¯¹æ•æ„Ÿæ¥å£å®ç°é€Ÿç‡é™åˆ¶
é˜²æ­¢æ¶æ„è¯·æ±‚å’Œæ»¥ç”¨
è°ƒè¯•ä¸æµ‹è¯•
å‰ç«¯æä¾›äº†æµ‹è¯• API å®¢æˆ·ç«¯ï¼Œä½äº src/renderer/src/api/test-api.tsï¼Œåç«¯å¼€å‘äººå‘˜å¯ä»¥å‚è€ƒè¯¥æ–‡ä»¶äº†è§£å‰ç«¯çš„ API è°ƒç”¨æ–¹å¼ã€‚

å¸¸è§é—®é¢˜
JWT è¿‡æœŸå¤„ç†ï¼šå‰ç«¯ä¼šè‡ªåŠ¨å¤„ç† Token è¿‡æœŸï¼Œåç«¯éœ€è¿”å› 401 çŠ¶æ€ç 
WebSocket è¿æ¥æ–­å¼€ï¼šå‰ç«¯ä¼šè‡ªåŠ¨é‡è¿ï¼Œåç«¯éœ€æ­£ç¡®å¤„ç†è¿æ¥çŠ¶æ€
è·¨åŸŸé—®é¢˜ï¼šå¼€å‘ç¯å¢ƒä¸­éœ€é…ç½® CORS å…è®¸å‰ç«¯åŸŸåè®¿é—®
æ›´å¤šèµ„æº
å®Œæ•´ API æ–‡æ¡£ï¼šsrc/renderer/src/api/API_DOCUMENTATION.md å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š

Virtual Office API æ¥å£æ–‡æ¡£
æœ¬æ–‡æ¡£æè¿°äº†Virtual Officeå‰ç«¯ä¸Spring Bootåç«¯ä¹‹é—´çš„æ‰€æœ‰APIäº¤äº’æ¥å£ã€‚

åŸºç¡€é…ç½®
APIåŸºç¡€URL: http://localhost:8080/api/v1
è®¤è¯æ–¹å¼: JWT Token (Bearer è®¤è¯)
è¯·æ±‚/å“åº”æ ¼å¼: JSON
1. ç”¨æˆ·è®¤è¯ (Authentication)
1.1 ç”¨æˆ·ç™»å½•
URL: /auth/login æ–¹æ³•: POST è¯·æ±‚ä½“:

{
  "email": "user@example.com",
  "password": "password123",
  "rememberMe": true
}
æˆåŠŸå“åº”:

{
  "token": "jwt_token_here",
  "user": {
    "id": "1",
    "name": "John Doe",
    "email": "user@example.com",
    "avatar": "https://example.com/avatar.jpg",
    "role": "user",
    "status": "online"
  }
}
1.2 ç”¨æˆ·æ³¨å†Œ
URL: /auth/register æ–¹æ³•: POST è¯·æ±‚ä½“:

{
  "name": "John Doe",
  "email": "user@example.com",
  "password": "password123",
  "confirmPassword": "password123",
  "role": "user"
}
æˆåŠŸå“åº”:

{
  "token": "jwt_token_here",
  "user": {
    "id": "1",
    "name": "John Doe",
    "email": "user@example.com",
    "role": "user"
  }
}
1.3 è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
URL: /auth/me æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "id": "1",
  "name": "John Doe",
  "email": "user@example.com",
  "avatar": "https://example.com/avatar.jpg",
  "role": "user",
  "status": "online"
}
1.4 æ›´æ–°ç”¨æˆ·ä¿¡æ¯
URL: /auth/profile æ–¹æ³•: PUT è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "name": "John Smith",
  "avatar": "https://example.com/new_avatar.jpg"
}
æˆåŠŸå“åº”:

{
  "id": "1",
  "name": "John Smith",
  "email": "user@example.com",
  "avatar": "https://example.com/new_avatar.jpg",
  "role": "user"
}
1.5 å¿˜è®°å¯†ç 
URL: /auth/forgot-password æ–¹æ³•: POST è¯·æ±‚ä½“:

{
  "email": "user@example.com"
}
æˆåŠŸå“åº”:

{
  "success": true,
  "message": "é‡ç½®å¯†ç é‚®ä»¶å·²å‘é€"
}
1.6 é‡ç½®å¯†ç 
URL: /auth/reset-password æ–¹æ³•: POST è¯·æ±‚ä½“:

{
  "token": "reset_token_here",
  "newPassword": "new_password123",
  "confirmPassword": "new_password123"
}
æˆåŠŸå“åº”:

{
  "success": true,
  "message": "å¯†ç é‡ç½®æˆåŠŸ"
}
2. è™šæ‹Ÿç©ºé—´ (Virtual Space)
2.1 è·å–æ‰€æœ‰è™šæ‹Ÿç©ºé—´
URL: /virtual-spaces æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

[
  {
    "id": "1",
    "name": "Main Office",
    "description": "Main virtual office space",
    "zones": [...],
    "createdAt": "2023-01-01T00:00:00Z"
  }
]
2.2 è·å–è™šæ‹Ÿç©ºé—´è¯¦æƒ…
URL: /virtual-spaces/:spaceId æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "id": "1",
  "name": "Main Office",
  "description": "Main virtual office space",
  "zones": [
    {
      "id": "zone1",
      "spaceId": "1",
      "name": "Work Area",
      "type": "workspace",
      "coordinates": {
        "x": 0,
        "y": 0,
        "width": 100,
        "height": 100
      }
    }
  ],
  "createdAt": "2023-01-01T00:00:00Z"
}
2.3 æ›´æ–°ç”¨æˆ·ä½ç½®
URL: /virtual-spaces/position æ–¹æ³•: PUT è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "spaceId": "1",
  "zoneId": "zone1",
  "x": 50,
  "y": 30
}
æˆåŠŸå“åº”:

{
  "id": "presence1",
  "userId": "1",
  "spaceId": "1",
  "zoneId": "zone1",
  "position": { "x": 50, "y": 30 },
  "status": "online",
  "lastActive": "2023-01-01T10:00:00Z"
}
2.4 è¿›å…¥è™šæ‹Ÿç©ºé—´
URL: /virtual-spaces/:spaceId/enter æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "id": "presence1",
  "userId": "1",
  "spaceId": "1",
  "position": { "x": 0, "y": 0 },
  "status": "online",
  "lastActive": "2023-01-01T10:00:00Z"
}
2.5 ç¦»å¼€è™šæ‹Ÿç©ºé—´
URL: /virtual-spaces/:spaceId/leave æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "success": true
}
2.6 è·å–ç©ºé—´æˆå‘˜
URL: /virtual-spaces/:spaceId/members æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

[
  {
    "id": "presence1",
    "userId": "1",
    "spaceId": "1",
    "position": { "x": 50, "y": 30 },
    "status": "online",
    "lastActive": "2023-01-01T10:00:00Z"
  }
]
3. èŠå¤©åŠŸèƒ½ (Chat)
3.1 è·å–èŠå¤©é¢‘é“åˆ—è¡¨
URL: /chat/channels æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

[
  {
    "id": "channel1",
    "name": "General",
    "type": "public",
    "members": [...],
    "createdAt": "2023-01-01T00:00:00Z",
    "lastMessage": {
      "id": "msg1",
      "content": "Hello everyone",
      "createdAt": "2023-01-01T10:00:00Z"
    }
  }
]
3.2 è·å–èŠå¤©æ¶ˆæ¯
URL: /chat/channels/:channelId/messages æ–¹æ³•: GET æŸ¥è¯¢å‚æ•°: limit=50&offset=0 è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

[
  {
    "id": "msg1",
    "channelId": "channel1",
    "senderId": "1",
    "content": "Hello everyone",
    "type": "text",
    "createdAt": "2023-01-01T10:00:00Z",
    "sender": {
      "id": "1",
      "name": "John Doe",
      "avatar": "https://example.com/avatar.jpg"
    }
  }
]
3.3 å‘é€æ¶ˆæ¯
URL: /chat/channels/:channelId/messages æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "content": "Hello there!",
  "type": "text"
}
æˆåŠŸå“åº”:

{
  "id": "msg2",
  "channelId": "channel1",
  "senderId": "1",
  "content": "Hello there!",
  "type": "text",
  "createdAt": "2023-01-01T10:05:00Z"
}
3.4 ç¿»è¯‘æ¶ˆæ¯
URL: /chat/messages/:messageId/translate æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "targetLanguage": "zh"
}
æˆåŠŸå“åº”:

{
  "translatedText": "ä½ å¥½ï¼",
  "sourceLanguage": "en",
  "targetLanguage": "zh"
}
3.5 åˆ›å»ºèŠå¤©é¢‘é“
URL: /chat/channels æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "name": "Project Team",
  "type": "group"
}
æˆåŠŸå“åº”:

{
  "id": "channel2",
  "name": "Project Team",
  "type": "group",
  "members": [...],
  "createdAt": "2023-01-01T11:00:00Z"
}
4. ä¼šè®®åŠŸèƒ½ (Meeting)
4.1 è·å–ä¼šè®®å®¤åˆ—è¡¨
URL: /meetings/rooms æ–¹æ³•: GET è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

[
  {
    "id": "meeting1",
    "name": "Conference Room A",
    "capacity": 10,
    "isLocked": false,
    "participants": [...]
  }
]
4.2 åˆ›å»ºä¼šè®®å®¤
URL: /meetings/rooms æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "name": "Team Meeting",
  "virtualSpaceId": "1",
  "capacity": 8
}
æˆåŠŸå“åº”:

{
  "id": "meeting2",
  "name": "Team Meeting",
  "virtualSpaceId": "1",
  "capacity": 8,
  "isLocked": false,
  "participants": []
}
4.3 åŠ å…¥ä¼šè®®
URL: /meetings/rooms/:meetingId/join æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "id": "participant1",
  "meetingId": "meeting1",
  "userId": "1",
  "user": {
    "id": "1",
    "name": "John Doe"
  },
  "isHost": false,
  "isSpeaking": false,
  "hasMic": true,
  "hasCamera": true,
  "hasHandRaised": false,
  "joinedAt": "2023-01-01T12:00:00Z"
}
4.4 ç¦»å¼€ä¼šè®®
URL: /meetings/rooms/:meetingId/leave æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token æˆåŠŸå“åº”:

{
  "success": true
}
4.5 æ›´æ–°å‚ä¸è€…çŠ¶æ€
URL: /meetings/rooms/:meetingId/participant/status æ–¹æ³•: PUT è®¤è¯: éœ€è¦JWT Token è¯·æ±‚ä½“:

{
  "hasMic": false,
  "hasCamera": true,
  "hasHandRaised": false
}
æˆåŠŸå“åº”:

{
  "id": "participant1",
  "meetingId": "meeting1",
  "userId": "1",
  "hasMic": false,
  "hasCamera": true,
  "hasHandRaised": false
}
4.6 å¼€å§‹/åœæ­¢å½•åˆ¶
URL: /meetings/rooms/:meetingId/recording/start æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token (ä¸»æŒäºº) æˆåŠŸå“åº”:

{
  "success": true,
  "recordingId": "recording1"
}
URL: /meetings/rooms/:meetingId/recording/stop æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token (ä¸»æŒäºº) æˆåŠŸå“åº”:

{
  "success": true,
  "recordingUrl": "https://example.com/recordings/recording1.mp4"
}
5. æ–‡ä»¶ä¸Šä¼ 
5.1 ä¸Šä¼ æ–‡ä»¶
URL: /upload æ–¹æ³•: POST è®¤è¯: éœ€è¦JWT Token Content-Type: multipart/form-data è¡¨å•æ•°æ®:

file: æ–‡ä»¶å¯¹è±¡
æˆåŠŸå“åº”:

{
  "url": "https://example.com/uploads/file123.jpg",
  "filename": "document.pdf",
  "size": 204800,
  "type": "application/pdf",
  "id": "file123"
}
6. WebSocketé€šä¿¡
6.1 è¿æ¥ä¿¡æ¯
URL: ws://localhost:8080/ws è®¤è¯: éœ€è¦åœ¨URLå‚æ•°ä¸­æä¾›JWT Token: ?token=jwt_token_here

6.2 æ¶ˆæ¯ç±»å‹
ç”¨æˆ·ä½ç½®æ›´æ–°:

{
  "type": "POSITION_UPDATE",
  "data": {
    "userId": "1",
    "spaceId": "1",
    "position": { "x": 50, "y": 30 }
  }
}
æ–°æ¶ˆæ¯é€šçŸ¥:

{
  "type": "NEW_MESSAGE",
  "data": {
    "channelId": "channel1",
    "message": {...}
  }
}
ä¼šè®®çŠ¶æ€æ›´æ–°:

{
  "type": "MEETING_STATUS",
  "data": {
    "meetingId": "meeting1",
    "participants": [...]
  }
}
é”™è¯¯å¤„ç†
æ‰€æœ‰APIè¿”å›æ ‡å‡†çš„HTTPçŠ¶æ€ç :

200 OK: è¯·æ±‚æˆåŠŸ
400 Bad Request: è¯·æ±‚å‚æ•°é”™è¯¯
401 Unauthorized: æœªæˆæƒ
403 Forbidden: æƒé™ä¸è¶³
404 Not Found: èµ„æºä¸å­˜åœ¨
500 Internal Server Error: æœåŠ¡å™¨é”™è¯¯
é”™è¯¯å“åº”æ ¼å¼:

{
  "error": "é”™è¯¯æ¶ˆæ¯",
  "message": "è¯¦ç»†é”™è¯¯æè¿°"
}

TypeScript ç±»å‹å®šä¹‰ï¼šsrc/renderer/src/types/index.ts å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š

// ç»Ÿä¸€çš„ç”¨æˆ·ç±»å‹å®šä¹‰
export interface User {
  id: string;
  name: string;
  avatar: string;
  avatarType?: 'emoji' | 'image';
  status: 'online' | 'away' | 'busy' | 'offline';
  role: string;
  position?: { x: number; y: number };
  email?: string; // å¯é€‰å­—æ®µï¼Œä»…åœ¨è®¤è¯æ—¶ä½¿ç”¨
}

æ•°æ®åº“è®¾è®¡ï¼š
use office_db;
- - ä¼ä¸šä¸æˆå‘˜
CREATE TABLE tenant (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
code VARCHAR(64) NOT NULL UNIQUE,
name VARCHAR(128) NOT NULL,
contact_email VARCHAR(128),
contact_phone VARCHAR(32),
plan_type VARCHAR(64) NOT NULL,
status TINYINT NOT NULL DEFAULT 1, -- 1:å¯ç”¨ 0:åœç”¨
expired_at DATETIME NULL,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE tenant_subscription (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
plan_name VARCHAR(64) NOT NULL,
seat_limit INT NOT NULL,
feature_flags JSON,
start_time DATETIME NOT NULL,
end_time DATETIME NOT NULL,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id)
);

CREATE TABLE user_account (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
username VARCHAR(64) NOT NULL UNIQUE,
email VARCHAR(128) UNIQUE,
phone VARCHAR(32) UNIQUE,
password_hash VARCHAR(255) NOT NULL,
default_lang VARCHAR(16) DEFAULT 'en',
timezone VARCHAR(64) DEFAULT 'UTC',
status TINYINT NOT NULL DEFAULT 1,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE tenant_member (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
user_id BIGINT NOT NULL,
display_name VARCHAR(128),
title VARCHAR(128),
role_code VARCHAR(64),
permissions JSON,
joined_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
status TINYINT NOT NULL DEFAULT 1,
UNIQUE KEY uk_tenant_user (tenant_id, user_id),
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (user_id) REFERENCES user_account(id)
);

CREATE TABLE member_profile (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
member_id BIGINT NOT NULL UNIQUE,
avatar_url VARCHAR(255),
avatar_config JSON,
signature VARCHAR(255),
bgm_url VARCHAR(255),
theme VARCHAR(64),
updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (member_id) REFERENCES tenant_member(id)
);

- - è™šæ‹ŸåŠå…¬å®¤
CREATE TABLE virtual_space (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
name VARCHAR(128) NOT NULL,
layout_config JSON NOT NULL,
max_capacity INT DEFAULT 100,
background_url VARCHAR(255),
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id)
);

CREATE TABLE virtual_space_zone (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
space_id BIGINT NOT NULL,
name VARCHAR(128) NOT NULL,
zone_type VARCHAR(64),
area_config JSON,
constraints JSON,
FOREIGN KEY (space_id) REFERENCES virtual_space(id)
);

CREATE TABLE member_presence (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
member_id BIGINT NOT NULL,
space_id BIGINT NOT NULL,
zone_id BIGINT,
pos_x DECIMAL(10,4),
pos_y DECIMAL(10,4),
status VARCHAR(32) NOT NULL, -- online, away, busy...
last_heartbeat DATETIME NOT NULL,
INDEX idx_space_member (space_id, member_id),
FOREIGN KEY (member_id) REFERENCES tenant_member(id),
FOREIGN KEY (space_id) REFERENCES virtual_space(id),
FOREIGN KEY (zone_id) REFERENCES virtual_space_zone(id)
);

CREATE TABLE presence_event_log (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
member_id BIGINT NOT NULL,
event_type VARCHAR(32) NOT NULL, -- login/logout/move
detail JSON,
occurred_at DATETIME NOT NULL,
INDEX idx_member_time (member_id, occurred_at),
FOREIGN KEY (member_id) REFERENCES tenant_member(id)
);

- - èŠå¤©ä¸ç¿»è¯‘
CREATE TABLE chat_channel (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
channel_type VARCHAR(32) NOT NULL, -- direct/group/system
name VARCHAR(128),
owner_member_id BIGINT,
metadata JSON,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (owner_member_id) REFERENCES tenant_member(id)
);

CREATE TABLE chat_channel_member (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
channel_id BIGINT NOT NULL,
member_id BIGINT NOT NULL,
role_code VARCHAR(32),
mute_until DATETIME,
UNIQUE KEY uk_channel_member (channel_id, member_id),
FOREIGN KEY (channel_id) REFERENCES chat_channel(id),
FOREIGN KEY (member_id) REFERENCES tenant_member(id)
);

CREATE TABLE chat_message (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
channel_id BIGINT NOT NULL,
sender_member_id BIGINT NOT NULL,
message_type VARCHAR(32) NOT NULL, -- text/image/file/voice
content TEXT,
extra JSON,
reply_to BIGINT,
recalled TINYINT DEFAULT 0,
sent_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
INDEX idx_channel_time (channel_id, sent_at),
FOREIGN KEY (channel_id) REFERENCES chat_channel(id),
FOREIGN KEY (sender_member_id) REFERENCES tenant_member(id),
FOREIGN KEY (reply_to) REFERENCES chat_message(id)
);

CREATE TABLE chat_translation (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
message_id BIGINT NOT NULL,
target_lang VARCHAR(16) NOT NULL,
translated_text TEXT NOT NULL,
engine VARCHAR(64),
latency_ms INT,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
UNIQUE KEY uk_msg_lang (message_id, target_lang),
FOREIGN KEY (message_id) REFERENCES chat_message(id)
);

CREATE TABLE chat_attachment (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
message_id BIGINT NOT NULL,
file_name VARCHAR(255),
file_type VARCHAR(64),
file_size BIGINT,
storage_url VARCHAR(255),
encryption_meta JSON,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (message_id) REFERENCES chat_message(id)
);

- - å¿«é€Ÿä¼šè®®
CREATE TABLE meeting_room (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
host_member_id BIGINT NOT NULL,
topic VARCHAR(255),
meeting_type VARCHAR(32), -- ad-hoc/scheduled
start_time DATETIME NOT NULL,
end_time DATETIME,
status VARCHAR(32) NOT NULL, -- planned/live/ended
options JSON, -- tokenç­–ç•¥/å½•åˆ¶é…ç½®
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (host_member_id) REFERENCES tenant_member(id)
);

CREATE TABLE meeting_participant (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
meeting_id BIGINT NOT NULL,
member_id BIGINT,
guest_email VARCHAR(128),
role_code VARCHAR(32), -- host/cohost/attendee
joined_at DATETIME,
left_at DATETIME,
device_info JSON,
screen_share TINYINT DEFAULT 0,
UNIQUE KEY uk_meeting_member (meeting_id, member_id),
FOREIGN KEY (meeting_id) REFERENCES meeting_room(id),
FOREIGN KEY (member_id) REFERENCES tenant_member(id)
);

CREATE TABLE meeting_invitation (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
meeting_id BIGINT NOT NULL,
inviter_id BIGINT NOT NULL,
invitee_id BIGINT,
invitee_email VARCHAR(128),
status VARCHAR(32) NOT NULL, -- pending/accepted/declined
expires_at DATETIME,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (meeting_id) REFERENCES meeting_room(id),
FOREIGN KEY (inviter_id) REFERENCES tenant_member(id),
FOREIGN KEY (invitee_id) REFERENCES tenant_member(id)
);

CREATE TABLE meeting_recording (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
meeting_id BIGINT NOT NULL,
storage_url VARCHAR(255) NOT NULL,
duration_sec INT,
transcript_url VARCHAR(255),
status VARCHAR(32) NOT NULL, -- processing/done
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (meeting_id) REFERENCES meeting_room(id)
);

- - å‘¼å«/å¿«é€Ÿäº¤æµ
CREATE TABLE call_session (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
caller_member_id BIGINT NOT NULL,
callee_member_id BIGINT NOT NULL,
call_type VARCHAR(32) NOT NULL, -- audio/video
status VARCHAR(32) NOT NULL, -- ringing/connected/ended
started_at DATETIME,
ended_at DATETIME,
metadata JSON,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (caller_member_id) REFERENCES tenant_member(id),
FOREIGN KEY (callee_member_id) REFERENCES tenant_member(id)
);

CREATE TABLE call_event_log (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
call_id BIGINT NOT NULL,
event_type VARCHAR(32) NOT NULL,
detail JSON,
occurred_at DATETIME NOT NULL,
FOREIGN KEY (call_id) REFERENCES call_session(id)
);

- - ç³»ç»Ÿæ”¯æ’‘
CREATE TABLE notification_task (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT,
target_member_id BIGINT,
channel VARCHAR(32) NOT NULL, -- websocket/email/push
template_code VARCHAR(64),
payload JSON,
status VARCHAR(32) NOT NULL, -- pending/sent/failed
retry_count INT DEFAULT 0,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
sent_at DATETIME,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (target_member_id) REFERENCES tenant_member(id)
);

CREATE TABLE translator_usage (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
engine VARCHAR(64) NOT NULL,
char_count INT NOT NULL,
cost_cent DECIMAL(10,2),
requested_by BIGINT,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (requested_by) REFERENCES tenant_member(id)
);

CREATE TABLE activity_audit (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT,
actor_member_id BIGINT,
action VARCHAR(64) NOT NULL,
target_type VARCHAR(64),
target_id VARCHAR(64),
detail JSON,
ip_address VARCHAR(64),
user_agent VARCHAR(255),
result VARCHAR(32),
occurred_at DATETIME NOT NULL,
INDEX idx_tenant_time (tenant_id, occurred_at),
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (actor_member_id) REFERENCES tenant_member(id)
);

CREATE TABLE file_resource (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT,
module VARCHAR(64) NOT NULL,
file_name VARCHAR(255),
storage_key VARCHAR(255) NOT NULL,
mime_type VARCHAR(128),
size_bytes BIGINT,
hash_sha256 VARCHAR(128),
visibility VARCHAR(32) NOT NULL, -- private/public
created_by BIGINT,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id),
FOREIGN KEY (created_by) REFERENCES tenant_member(id)
);

CREATE TABLE webhook_endpoint (
id BIGINT PRIMARY KEY AUTO_INCREMENT,
tenant_id BIGINT NOT NULL,
name VARCHAR(128),
url VARCHAR(255) NOT NULL,
secret VARCHAR(128),
events JSON,
status TINYINT NOT NULL DEFAULT 1,
created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (tenant_id) REFERENCES tenant(id)
);
